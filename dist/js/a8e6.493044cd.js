(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["a8e6"],{a8e6:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-form",{ref:"form2",on:{submit:function(e){return e.preventDefault(),t.validateBeforeSubmit(e)}}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md12:""}},[a("v-card",{staticClass:"elevation-0"},[a("v-card-title",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md12:""}},[a("span",{staticClass:"headline"},[t._v("\n                  Configuração do Mailing Diário\n                ")])]),a("v-flex",{attrs:{md12:""}},[a("span",{staticClass:"body-1"},[t._v("\n                  Configure os filtros que serão utilizados para geração do mailing(todos os dias à meia noite) e\n                  informe os endereços de e-mail que receberão esse mailing.\n                ")])])],1)],1),a("v-card-text",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md12:""}},[a("core-filtro-rede-empresa-loja",{attrs:{"show-todas":!0,obrigatorio:!1},model:{value:t.filtros,callback:function(e){t.filtros=e},expression:"filtros"}})],1),a("v-flex",{attrs:{md2:"",sm6:"",xs12:""}},[a("v-text-field",{attrs:{label:"Atraso De",type:"number",reverse:""},model:{value:t.filtros.atrasoDe,callback:function(e){t.$set(t.filtros,"atrasoDe",e)},expression:"filtros.atrasoDe"}})],1),a("v-flex",{attrs:{md2:"",sm6:"",xs12:""}},[a("v-text-field",{attrs:{label:"Atraso Até",type:"number",reverse:""},model:{value:t.filtros.atrasoAte,callback:function(e){t.$set(t.filtros,"atrasoAte",e)},expression:"filtros.atrasoAte"}})],1),a("v-flex",{attrs:{md2:"",sm6:"",xs12:""}},[a("v-text-field",{directives:[{name:"formata-moeda",rawName:"v-formata-moeda",value:t.filtros.saldoDevedor,expression:"filtros.saldoDevedor"},{name:"money",rawName:"v-money",value:t.money,expression:"money"}],attrs:{label:"Saldo Devedor Até",type:"tel",suffix:"R$",reverse:"",hint:"0,00 é todas as faixas"},model:{value:t.filtros.saldoDevedor,callback:function(e){t.$set(t.filtros,"saldoDevedor",e)},expression:"filtros.saldoDevedor"}})],1),a("v-flex",{attrs:{md3:"",sm6:"",xs12:""}},[a("v-autocomplete",{attrs:{items:t.clientesAcordo,label:"Clientes Acordo","item-value":"id","item-text":"descricao"},model:{value:t.filtros.clienteEmAcordo,callback:function(e){t.$set(t.filtros,"clienteEmAcordo",e)},expression:"filtros.clienteEmAcordo"}})],1),a("v-flex",{attrs:{md3:"",sm6:"",xs12:""}},[a("v-autocomplete",{attrs:{items:t.atrasoMes,label:"Atraso Mês","item-value":"id","item-text":"descricao"},model:{value:t.filtros.atrasoMes,callback:function(e){t.$set(t.filtros,"atrasoMes",e)},expression:"filtros.atrasoMes"}})],1),a("v-flex",{attrs:{md6:"",sm12:""}},[a("v-checkbox",{attrs:{label:"Incluir os clientes que estão SERASA/SPC"},model:{value:t.filtros.incluirClienteSPC,callback:function(e){t.$set(t.filtros,"incluirClienteSPC",e)},expression:"filtros.incluirClienteSPC"}})],1),a("v-flex",{attrs:{md6:"",sm12:""}},[a("v-checkbox",{attrs:{label:"Incluir agendamentos"},model:{value:t.filtros.incluirAgendamento,callback:function(e){t.$set(t.filtros,"incluirAgendamento",e)},expression:"filtros.incluirAgendamento"}})],1),a("v-flex",{attrs:{md12:""}},[a("v-card",[a("v-toolbar",{attrs:{flat:"",color:"white"}},[a("v-toolbar-title",[t._v("Contatos que Receberão este Mailing por Email")]),a("v-divider",{staticClass:"mx-2",attrs:{inset:"",vertical:""}}),a("v-spacer"),a("v-btn",{attrs:{small:"",fab:"",color:"primary"}},[a("v-icon",{on:{click:function(e){t.novoContato()}}},[t._v("mdi-plus")])],1)],1),a("v-card-text",[a("v-data-table",{attrs:{headers:t.headersContato,items:t.filtros.contatos,"hide-actions":""},scopedSlots:t._u([{key:"items",fn:function(e){var o=e.item;return[a("tr",[a("td",[t._v(t._s(o.nome))]),a("td",[t._v(t._s(o.email))]),a("td",{staticClass:"justify-end layout ma-2"},[a("v-icon",{staticClass:"mr-2",attrs:{color:"blue",title:"Alterar"},on:{click:function(e){t.editContato(o)}}},[t._v("mdi-pencil")]),a("v-icon",{attrs:{color:"red",title:"Excluir"},on:{click:function(e){t.deleteContato(o)}}},[t._v("mdi-delete")])],1)])]}}])})],1)],1)],1)],1)],1)],1)],1),a("v-flex",{attrs:{md12:""}},[a("v-layout",{staticClass:"justify-end"},[a("v-btn",{attrs:{loading:t.loadingBtn,color:"secondary",title:"Gera o Mailing sem salvar e sem enviar por e-mail"},on:{click:function(e){t.geraMailingDownload()}}},[a("v-icon",[t._v("mdi-file-excel")]),t._v("\n            Gerar Mailing e Download\n          ")],1),a("v-btn",{attrs:{loading:t.loadingBtn,type:"submit",color:"primary"}},[t._v("Salvar")])],1)],1),a("core-progress-modal",{attrs:{show:t.loading}})],1)],1),t.dialogContato?[a("v-layout",{attrs:{row:"","justify-center":""}},[a("v-dialog",{attrs:{"max-width":"390"},model:{value:t.dialogContato,callback:function(e){t.dialogContato=e},expression:"dialogContato"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[t._v("Novo Contato Mailing")]),a("v-card-text",[a("v-form",{ref:"formContato",attrs:{"lazy-validation":""},on:{submit:function(e){return e.preventDefault(),t.addContato(e)}},model:{value:t.isValid,callback:function(e){t.isValid=e},expression:"isValid"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md12:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{"error-messages":t.errors.collect("Nome"),label:"Nome","data-vv-name":"Nome",required:""},model:{value:t.contatoMailing.nome,callback:function(e){t.$set(t.contatoMailing,"nome",e)},expression:"contatoMailing.nome"}})],1),a("v-flex",{attrs:{md12:""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required|email",expression:"'required|email'"}],attrs:{"error-messages":t.errors.collect("Email"),type:"email",label:"Email","data-vv-name":"Email",required:""},model:{value:t.contatoMailing.email,callback:function(e){t.$set(t.contatoMailing,"email",e)},expression:"contatoMailing.email"}})],1),a("v-flex",{attrs:{md12:""}},[a("v-layout",{staticClass:"justify-end"},[a("v-btn",{attrs:{disabled:!t.isValid,color:"primary",type:"submit"}},[t._v("Add")])],1)],1)],1)],1)],1)],1)],1)],1)]:t._e()],2)},i=[],l=(a("28a5"),a("3a86")),r=a("5a50"),n={props:{clientesAcordo:{type:Array,requided:!0},faturas:{type:Array,requided:!0},atrasoMes:{type:Array,requided:!0}},data:function(){return{dialogContato:!1,isValid:!1,money:r["i"],filtros:{redeId:r["k"],empresaId:r["k"],lojaId:r["k"],atrasoDe:null,atrasoAte:null,incluirAgendamento:!0,clienteEmAcordo:"",incluirClienteSPC:!1,fatura:"",atrasoMes:r["k"],configId:null,contatos:[]},contatoMailing:{},loadingBtn:!1,loading:!1,headersContato:[{sortable:!1,align:"left",text:"Nome",value:"nome"},{sortable:!1,align:"left",text:"Email",value:"email"},{sortable:!1,text:"",align:"right",width:"40px"}]}},beforeMount:function(){var t=this;this.loading=!0,l["j"].getConfigMailing(this.$root.usuarioId()).then(function(e){e.data&&(t.filtros=e.data)}).finally(function(){t.loading=!1})},methods:{validateBeforeSubmit:function(){var t=this;this.$validator.validate().then(function(e){e?(t.loading=!0,l["j"].salvarConfigMailing(t.filtros).then(function(e){t.$root.showSucesso("Operação realizada com sucesso"),t.filtros=e.data}).catch(function(e){return t.$root.showErro(e.data)}).finally(function(){t.loading=!1})):t.$root.showAlerta(t.$vuetify.t("$vuetify.Erro.camposObrigatorios"))})},addContato:function(){var t=this;this.$validator.validate().then(function(e){e?(t.dialogContato=!1,t.contatoMailing.edit||t.filtros.contatos.push(t.contatoMailing),t.cancelarContato()):t.$root.showAlerta(t.$vuetify.t("$vuetify.Erro.camposObrigatorios"))})},novoContato:function(){this.contatoMailing={nome:null,email:null,edit:!1},this.dialogContato=!0},cancelarContato:function(){this.contatoMailing={nome:null,email:null,edit:!1},this.dialogContato=!1},editContato:function(t){this.contatoMailing=t,this.contatoMailing.edit=!0,this.dialogContato=!0},deleteContato:function(t){this.filtros.contatos=this.filtros.contatos.filter(function(e){return e.nome!==t.nome&&e.email!==t.email})},geraMailingDownload:function(){var t=this;this.loading=!0,l["j"].geraRelatorioMailing(this.filtros).then(function(e){t.loading=!1;var a=window.URL.createObjectURL(new Blob([e.data])),o=document.createElement("a");o.href=a,o.setAttribute("download",e.headers["content-disposition"].split(";")[1].split("=")[1]),document.body.appendChild(o),o.click()}).catch(function(e){t.$root.showErro(e.data),t.loading=!1})}}},s=n,d=a("2877"),c=Object(d["a"])(s,o,i,!1,null,null,null);e["default"]=c.exports}}]);
//# sourceMappingURL=a8e6.493044cd.js.map