(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6db1","65e0","65e0"],{"65e0":function(a,e,t){"use strict";t("a481"),t("c5f6");e["a"]={convertStringToNumber:function(a){return a?Number(a.replaceAll(".","").replace(",",".").replace(/[^0-9.-]+/g,"")):0},calculaDescontoPercentual:function(a,e){if(e){var t=this.convertStringToNumber(e)/100;return console.log("percentualCalculado: "+t),console.log("valorBase: "+a),console.log("multiplicado: "+a*t),a*t}return 0},formatValorMonetario:function(a){return a?a.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):"0,00"}}},c762:function(a,e,t){"use strict";t.r(e);var o=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("v-container",{attrs:{fluid:"","grid-list-md":""}},[t("core-progress-modal",{attrs:{show:a.loading}}),a.loading?a._e():t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{attrs:{md12:""}},[t("v-form",{attrs:{novalidate:"",enctype:"multipart/form-data"},on:{submit:function(e){return e.preventDefault(),a.validateBeforeSubmit(e)}},model:{value:a.valid,callback:function(e){a.valid=e},expression:"valid"}},[t("v-card",{staticClass:"elevation-0"},[t("v-card-title",[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{attrs:{lg10:"",md8:"",sm8:""}},[t("h3",{staticClass:"headline mb-0"},[a._v("Recepcionar Lotes RPS")])]),a.mostrarBotoesDownload?t("v-flex",{staticClass:"layout justify-end mt-0",attrs:{lg1:"",md2:"",sm2:""}},[t("v-btn",{staticClass:"secondary",staticStyle:{width:"50px",height:"50px"},attrs:{title:"Download XML"},on:{click:function(e){a.downloadXml()}}},[t("v-layout",{attrs:{column:""}},[t("v-icon",[a._v("mdi-cloud-download-outline")]),a._v("\n                    XML\n                  ")],1)],1)],1):a._e(),a.mostrarBotoesDownload?t("v-flex",{staticClass:"layout justify-end mt-0",attrs:{lg1:"",md2:"",sm2:""}},[t("v-btn",{staticClass:"primary",staticStyle:{width:"50px",height:"50px"},attrs:{title:"Download Nota Fiscal"}},[t("v-layout",{attrs:{column:""}},[t("v-icon",[a._v("mdi-cloud-download-outline")]),t("a",{staticClass:"white--text",attrs:{href:a.form.linkNota,target:"_blank"}},[a._v("\n                      NOTA\n                    ")])],1)],1)],1):a._e(),a.disabled?t("v-flex",{staticClass:"layout align-center",attrs:{md12:""}},[t("core-status-rps",{attrs:{status:a.form.situacaoStr,mensagem:a.form.correcaoErro}}),a.form.correcaoErro?t("span",{staticClass:"caption"},[a._v(a._s(a.form.correcaoErro))]):a._e()],1):a._e()],1)],1),t("v-card-text",[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{attrs:{md12:""}},[t("core-filtro-rede-empresa-loja",{attrs:{"loja-selecionada":a.onChangeLoja,disabled:a.disabled},model:{value:a.form,callback:function(e){a.form=e},expression:"form"}})],1),t("v-flex",{attrs:{md2:""}},[t("v-text-field",{attrs:{disabled:a.disabled,label:"Número RPS",type:"tel"},model:{value:a.form.numeroRps,callback:function(e){a.$set(a.form,"numeroRps","string"===typeof e?e.trim():e)},expression:"form.numeroRps"}})],1),t("v-flex",{attrs:{md2:""}},[t("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{disabled:a.disabled,"error-messages":a.errors.collect("Data Emissão"),label:"Data Emissão","data-vv-name":"Data Emissão",type:"date",required:""},model:{value:a.form.dataEmissao,callback:function(e){a.$set(a.form,"dataEmissao",e)},expression:"form.dataEmissao"}})],1)],1),t("v-card",{staticClass:"elevation-0"},[t("v-card-title",[t("h3",{staticClass:"headline mb-0"},[a._v("Serviço do RPS")])]),t("v-card-text",[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{attrs:{md6:""}},[t("v-autocomplete",{attrs:{disabled:a.disabled,items:a.listNatureza,label:"Natureza da Operação","item-value":"id","item-text":"descricao"},model:{value:a.form.naturezaOperacao,callback:function(e){a.$set(a.form,"naturezaOperacao",e)},expression:"form.naturezaOperacao"}})],1),t("v-flex",{attrs:{md3:""}},[t("v-text-field",{directives:[{name:"formata-moeda",rawName:"v-formata-moeda",value:a.form.aliquota,expression:"form.aliquota"},{name:"money",rawName:"v-money",value:a.money,expression:"money"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{disabled:a.disabled,"error-messages":a.errors.collect("Alíquota"),"data-vv-name":"Alíquota",type:"tel",prefix:"%",maxlength:"5",reverse:"",label:"Alíquota"},model:{value:a.form.aliquota,callback:function(e){a.$set(a.form,"aliquota",e)},expression:"form.aliquota"}})],1),t("v-flex",{attrs:{md3:""}},[t("v-text-field",{directives:[{name:"formata-moeda",rawName:"v-formata-moeda",value:a.form.valorIr,expression:"form.valorIr"},{name:"money",rawName:"v-money",value:a.money,expression:"money"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{disabled:a.disabled,"error-messages":a.errors.collect("Valor IR"),"data-vv-name":"Valor IR",type:"tel",prefix:"%",maxlength:"5",reverse:"",label:"Valor IR"},model:{value:a.form.valorIr,callback:function(e){a.$set(a.form,"valorIr",e)},expression:"form.valorIr"}})],1),t("v-flex",{attrs:{md2:""}},[t("v-text-field",{directives:[{name:"formata-moeda",rawName:"v-formata-moeda",value:a.form.valorServicos,expression:"form.valorServicos"},{name:"money",rawName:"v-money",value:a.money,expression:"money"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{disabled:a.disabled,"error-messages":a.errors.collect("Valor do Serviço"),"data-vv-name":"Valor do Serviço",required:"",type:"tel",suffix:"R$",reverse:"",label:"Valor do Serviço"},model:{value:a.form.valorServicos,callback:function(e){a.$set(a.form,"valorServicos",e)},expression:"form.valorServicos"}})],1),t("v-flex",{attrs:{md2:""}},[t("v-text-field",{directives:[{name:"formata-moeda",rawName:"v-formata-moeda",value:a.baseCalculo,expression:"baseCalculo"},{name:"money",rawName:"v-money",value:a.money,expression:"money"}],attrs:{value:a.baseCalculo,disabled:"",suffix:"R$",label:"Base de Cálculo",reverse:""}})],1),t("v-flex",{attrs:{md2:""}},[t("v-text-field",{directives:[{name:"formata-moeda",rawName:"v-formata-moeda",value:a.valorLiquido,expression:"valorLiquido"},{name:"money",rawName:"v-money",value:a.money,expression:"money"}],attrs:{value:a.valorLiquido,disabled:"",suffix:"R$",type:"tel",reverse:"",label:"Valor Líquido"}})],1),t("v-flex",{attrs:{md12:""}},[t("v-textarea",{attrs:{disabled:a.disabled,type:"text",label:"Discriminação do Serviço",rows:"5",counter:"2000"},model:{value:a.form.discriminacao,callback:function(e){a.$set(a.form,"discriminacao",e)},expression:"form.discriminacao"}})],1)],1)],1)],1),a.disabled?a._e():t("v-card",{staticClass:"elevation-0"},[t("v-card-title",[t("h3",{staticClass:"headline mb-0"},[a._v("Certificado digital")])]),t("v-card-text",[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{attrs:{md12:""}},[t("label",{staticClass:"caption",staticStyle:{cursor:"pointer"},attrs:{for:"certificado",title:"Informe o certificado"}},[a._v("\n                      "+a._s(a.formData?a.formData.get("name"):"Informe o certificado")+"\n                      "),t("input",{attrs:{id:"certificado",type:"file"},on:{change:function(e){a.anexarCertificacao(e)}}})])]),t("v-flex",{attrs:{md12:""}},[t("v-text-field",{attrs:{label:"Senha Certificado",type:"password"},model:{value:a.form.senha,callback:function(e){a.$set(a.form,"senha",e)},expression:"form.senha"}})],1)],1)],1)],1)],1)],1),t("v-layout",{staticClass:"justify-end"},[a.disabled?[t("v-btn",{staticStyle:{color:"black !important"},attrs:{outline:""},on:{click:a.cancelar}},[a._v("Voltar")])]:[t("v-btn",{staticStyle:{color:"black !important"},attrs:{outline:""},on:{click:a.cancelar}},[a._v("Cancelar")]),t("v-btn",{attrs:{disabled:!a.valid,type:"submit",color:"primary"}},[a._v("Enviar RPS")])]],2)],1)],1)],1)],1)},r=[],l=(t("7f7f"),t("3a86")),i=t("5a50"),s=t("fa1c"),n=t("65e0"),m={data:function(){return{money:i["i"],formData:null,disabled:!1,form:{redeId:1,empresaId:6,lojaId:i["k"],senha:null,numeroLote:null,numeroRps:null,dataEmissao:s["a"].currentDate(),naturezaOperacao:1,status:null,correcaoErro:null,numeroRpsSubst:null,notaFiscal:null,numeroVerificacao:null,linkNota:null,dhNotaFiscal:null,valorIr:1.5,valorServicos:0,valorDeducoes:0,itemListaServico:null,baseCalculo:0,aliquota:5,discriminacao:null,valorLiquido:0},listNatureza:[],loading:!1,valid:!1,loadingBtn:!1}},computed:{baseCalculo:function(){return this.disabled?this.form.baseCalculo:this.form.valorServicos},valorLiquido:function(){if(this.disabled)return this.form.valorLiquido;if(this.form.valorServicos&&this.form.valorIr){var a=n["a"].convertStringToNumber(this.form.valorServicos),e=n["a"].calculaDescontoPercentual(a,this.form.valorIr);return console.log("desconto: "+e),n["a"].formatValorMonetario(a-e)}return this.form.valorServicos},mostrarBotoesDownload:function(){return this.disabled&&this.form.status&&4===this.form.status}},beforeMount:function(){var a=this;this.loading=!0,l["C"].getAllNaturezaOperacaoRps().then(function(e){a.listNatureza=e.data});var e=this.$route.params.loteId;e?(this.disabled=!0,l["A"].getLoteRps(e).then(function(e){a.form=e.data}).finally(function(){a.loading=!1})):(this.disabled=!1,l["A"].proximoNumeroRps().then(function(e){a.form.numeroRps=e.data}).finally(function(){a.loading=!1}))},methods:{validateBeforeSubmit:function(){var a=this;this.$validator.validate().then(function(e){e?a.salvarRps():a.$root.showAlerta(a.$vuetify.t("$vuetify.Erro.camposObrigatorios"))})},salvarRps:function(){var a=this;this.loading=this.loadingBtn=!0,this.form.valorLiquido=this.valorLiquido,this.form.baseCalculo=this.baseCalculo,this.formData.delete("form"),this.formData.append("form",JSON.stringify(this.form)),l["A"].gerarRPS(this.formData).then(function(e){a.$root.showSucesso(e.data),a.loading=a.loadingBtn=!1,a.cancelar()}).catch(function(e){a.$root.showErro(e.data),a.loading=a.loadingBtn=!1})},cancelar:function(){this.$router.push("/rps")},anexarCertificacao:function(a){if(a&&a.target&&a.target.files.length>0){var e=a.target.files[0];this.formData=new FormData,this.formData.append("file",e),this.formData.append("name",e.name)}},onChangeLoja:function(a){this.form.discriminacao="TAXA DE ADM ",a&&(this.form.discriminacao+=a.descricao),this.form.discriminacao+=".\n\nIRRF DE 1,5% SOB RESPONSABILIDADE DA PRATICO ADMINISTRADORA DE CARTOES E MEIOS DE PAGAMENTO LTDA CFE IN SRF 153/87, E LEI 7450/85 ART 53 C/C LEI 9064/1995 ART 6º."},downloadXml:function(){var a=new Blob([this.form.xmlNota],{type:"text/xml"}),e=window.URL.createObjectURL(a);window.open(e)}}},d=m,c=t("2877"),u=Object(c["a"])(d,o,r,!1,null,null,null);e["default"]=u.exports}}]);
//# sourceMappingURL=chunk-6db1.5d4d1209.js.map