(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["5148"],{5148:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("core-progress-modal",{attrs:{show:e.loading}}),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md12:""}},[a("material-card",{attrs:{color:"primary",title:"Gerar Remessa SPC"}},[a("v-card",{staticClass:"elevation-0"},[a("v-card-text",[a("v-form",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md12:""}},[e._v("\n                  Informe abaixo o tipo da remessa e os parâmetros de filtro para os clientes que deseja enviar/retirar de restrição cadastral.\n                ")]),a("v-flex",{attrs:{md2:""}},[a("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{items:e.servicoSpcList,"error-messages":e.errors.collect("Tipo"),"item-value":"id","item-text":"descricao","data-vv-name":"Tipo",label:"Tipo"},on:{change:e.onChangeServicoSPC},model:{value:e.filtros.servicoSPC,callback:function(t){e.$set(e.filtros,"servicoSPC",t)},expression:"filtros.servicoSPC"}})],1),a("v-flex",{attrs:{md3:""}},[a("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{items:e.redes,"error-messages":e.errors.collect("Rede"),"item-value":"id","item-text":"descricao","data-vv-name":"Rede",label:"Rede"},on:{change:e.carregaEmpresas},model:{value:e.filtros.redeId,callback:function(t){e.$set(e.filtros,"redeId",t)},expression:"filtros.redeId"}})],1),a("v-flex",{attrs:{md4:""}},[a("v-autocomplete",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{items:e.empresas,"error-messages":e.errors.collect("Origem"),"item-value":"id","item-text":"descricao","data-vv-name":"Origem",label:"Origem"},model:{value:e.filtros.empresaId,callback:function(t){e.$set(e.filtros,"empresaId",t)},expression:"filtros.empresaId"}})],1),a("v-flex",{attrs:{md3:"",layout:"","align-center":""}},[a("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{"error-messages":e.errors.collect("Dias em atraso"),label:"Dias em atraso",type:"number",min:"0"},model:{value:e.filtros.diasEmAtraso,callback:function(t){e.$set(e.filtros,"diasEmAtraso",t)},expression:"filtros.diasEmAtraso"}}),a("span",{staticClass:"ml-4 mr-4"},[e._v("a")]),a("v-text-field",{attrs:{label:"",type:"number",min:"0",maxlength:"5"},model:{value:e.filtros.diasEmAtrasoAte,callback:function(t){e.$set(e.filtros,"diasEmAtrasoAte",t)},expression:"filtros.diasEmAtrasoAte"}})],1),a("v-flex",{attrs:{"ml-1":"",md3:"",layout:"","align-center":""}},[a("v-text-field",{directives:[{name:"formata-moeda",rawName:"v-formata-moeda",value:e.filtros.valorEmAtraso,expression:"filtros.valorEmAtraso"},{name:"money",rawName:"v-money",value:e.money,expression:"money"}],attrs:{label:"Valor em atraso"},model:{value:e.filtros.valorEmAtraso,callback:function(t){e.$set(e.filtros,"valorEmAtraso",t)},expression:"filtros.valorEmAtraso"}}),a("span",{staticClass:"ml-4 mr-4"},[e._v("a")]),a("v-text-field",{directives:[{name:"formata-moeda",rawName:"v-formata-moeda",value:e.filtros.valorEmAtrasoAte,expression:"filtros.valorEmAtrasoAte"},{name:"money",rawName:"v-money",value:e.money,expression:"money"}],attrs:{label:""},model:{value:e.filtros.valorEmAtrasoAte,callback:function(t){e.$set(e.filtros,"valorEmAtrasoAte",t)},expression:"filtros.valorEmAtrasoAte"}})],1),a("v-flex",{attrs:{md3:""}},[a("v-text-field",{attrs:{label:"Ult. Pagto Até",type:"date"},model:{value:e.filtros.ultimoPagtoAte,callback:function(t){e.$set(e.filtros,"ultimoPagtoAte",t)},expression:"filtros.ultimoPagtoAte"}})],1),a("v-flex",{attrs:{md6:""}},[a("v-autocomplete",{attrs:{items:e.clientesEmAcordo,label:"Clientes Acordo","item-value":"id","item-text":"descricao"},model:{value:e.filtros.clientesEmAcordoId,callback:function(t){e.$set(e.filtros,"clientesEmAcordoId",t)},expression:"filtros.clientesEmAcordoId"}})],1),a("v-checkbox",{staticClass:"mt-1",attrs:{label:"Gerar apenas as baixas"},model:{value:e.filtros.flgApenasBaixas,callback:function(t){e.$set(e.filtros,"flgApenasBaixas",t)},expression:"filtros.flgApenasBaixas"}}),a("v-checkbox",{staticClass:"mt-1",attrs:{label:"Negativar clientes já negativados por outros órgãos (SPC, SERASA, etc)?"},model:{value:e.filtros.flgNegJaNetativados,callback:function(t){e.$set(e.filtros,"flgNegJaNetativados",t)},expression:"filtros.flgNegJaNetativados"}}),a("v-checkbox",{staticClass:"mt-1",attrs:{label:"Negativar contas canceladas em perdas"},model:{value:e.filtros.flgNegContasCanceladas,callback:function(t){e.$set(e.filtros,"flgNegContasCanceladas",t)},expression:"filtros.flgNegContasCanceladas"}}),a("v-checkbox",{staticClass:"mt-1",attrs:{label:"Negativar clientes em todas as redes mesmo se já negativado em alguma rede?"},model:{value:e.filtros.flgNegEmTodasRedes,callback:function(t){e.$set(e.filtros,"flgNegEmTodasRedes",t)},expression:"filtros.flgNegEmTodasRedes"}}),a("v-checkbox",{staticClass:"mt-1",attrs:{label:"Negativar apenas clientes com proposta liberada/emitida?"},model:{value:e.filtros.flgNegApenasComProposta,callback:function(t){e.$set(e.filtros,"flgNegApenasComProposta",t)},expression:"filtros.flgNegApenasComProposta"}})],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{loading:e.loadingBtn,color:"primary"},on:{click:e.novaRemessa}},[e._v("Nova Remessa")])],1)],1)],1)],1),a("v-flex",{attrs:{md12:""}},[e.flgNovaRemessa?e._e():a("v-card",[a("v-toolbar",{attrs:{flat:"",color:"white"}},[a("v-toolbar-title",[e._v("Útimas Remessas Geradas")]),a("v-divider",{staticClass:"mx-2",attrs:{inset:"",vertical:""}})],1),a("v-progress-linear",{attrs:{active:e.loading,color:"light-blue",indeterminate:"",height:"3"}}),a("v-data-table",{staticClass:"elevation-1 arrow-pagintion",attrs:{headers:e.headersRemessas,items:e.items,loading:!0,"total-items":e.totalItems,pagination:e.pagination},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"items",fn:function(t){var s=t.item;return[a("td",{staticClass:"text-xs-center"},[a("a",{on:{click:function(t){e.downloadAnexo(s.anexoId)}}},[e._v("\n                "+e._s(s.nomeArquivo)+"\n              ")])]),a("td",{staticClass:"text-xs-right"},[e._v(e._s(s.qtdClientes))]),a("td",{staticClass:"text-xs-center"},[e._v(e._s(e._f("moment")(s.dataGeracao,"DD/MM/YYYY H:mm")))]),a("td",{staticClass:"justify-end layout mr-2"},[a("v-icon",{staticClass:"mr-2",attrs:{color:"primary",title:"Baixar Arquivo"},on:{click:function(t){e.downloadAnexo(s.anexoId)}}},[e._v("mdi-cloud-download-outline")])],1)]}}])})],1),e.flgNovaRemessa?a("v-card",[a("v-toolbar",{attrs:{flat:"",color:"white"}},[a("v-toolbar-title",[e._v("Foram encontrados "+e._s(e.clientes.length)+" clientes(s). ")])],1),a("v-progress-linear",{attrs:{active:e.loading,color:"light-blue",indeterminate:"",height:"3"}}),a("v-data-table",{staticClass:"elevation-1 arrow-pagintion",attrs:{headers:e.headersClientes,items:e.clientes,loading:!0,"hide-actions":""},scopedSlots:e._u([{key:"items",fn:function(t){var s=t.item;return[a("td",[e._v(e._s(s.nomeCliente))]),a("td",{staticClass:"text-xs-center"},[a("a",{attrs:{href:"/cad-cliente/"+s.clienteId+"/"+s.lojaId}},[e._v("\n                "+e._s(s.cpf)+"\n              ")])]),a("td",{staticClass:"text-xs-center"},["Exclusão"===s.operacao?a("v-chip",{staticClass:"ml-0",attrs:{color:"green","text-color":"white",small:""}},[a("v-avatar",{staticClass:"green darken-4"},[e._v("E")]),e._v("\n                "+e._s(s.operacao)+"\n              ")],1):a("v-chip",{staticClass:"ml-0",attrs:{color:"red","text-color":"white",small:""}},[a("v-avatar",{staticClass:"red darken-4"},[e._v("I")]),e._v("\n                "+e._s(s.operacao)+"\n              ")],1)],1),a("td",{staticClass:"text-xs-center"},[e._v(e._s(e._f("moment")(s.dataNascimento,"DD/MM/YYYY")))]),a("td",{staticClass:"text-xs-center"},[e._v(e._s(s.diasAtraso))]),a("td",{staticClass:"text-xs-right"},[e._v(e._s(s.valorAtraso.toLocaleString("pt-BR",{minimumFractionDigits:2})))]),a("td",{staticClass:"text-xs-center"},[e._v(e._s(e._f("moment")(s.ultimoPagtoAte,"DD/MM/YYYY")))]),a("td",[e._v(e._s(s.nomeLoja))]),a("td",{staticClass:"justify-end layout mr-2"},[a("a",{attrs:{href:"/cad-cliente/"+s.clienteId+"/"+s.lojaId}},[a("v-icon",{staticClass:"mr-2",attrs:{color:"primary"}},[e._v("mdi-magnify")])],1)])]}}])}),a("v-card-actions",[a("v-btn",{staticStyle:{color:"black !important"},attrs:{outline:""},on:{click:function(t){e.cancelarRemessa()}}},[e._v("Cancelar")]),a("v-spacer"),a("v-btn",{attrs:{disabled:0==e.clientes.length,loading:e.loadingBtn,color:"primary"},on:{click:function(t){e.gerarRemesa()}}},[e._v("Gerar")])],1)],1):e._e()],1)],1)],1)},o=[],r=a("3a86"),i=a("5a50"),l={props:{redes:{type:Array,requided:!0},clientesEmAcordo:{type:Array,requided:!0},servicoSpcList:{type:Array,requided:!0}},data:function(){return{money:i["i"],flgNovaRemessa:!1,item:null,clientes:[],filtros:{redeId:i["k"],empresaId:i["k"],servicoSPC:null,clientesEmAcordoId:i["k"],diasEmAtraso:null,diasEmAtrasoAte:null,valorEmAtraso:null,valorEmAtrasoAte:null,ultimoPagtoAte:null,flgApenasBaixas:!1,flgNegJaNetativados:!1,flgNegContasCanceladas:!1,flgNegEmTodasRedes:!1,flgNegApenasComProposta:!1},empresas:[],headersRemessas:[{sortable:!1,align:"center",text:"Arquivo",value:"arquivo"},{sortable:!1,align:"right",text:"Qtd. Clientes",value:"qtdClientes"},{sortable:!1,align:"center",text:"Data de Geração",value:"dataCadastro"},{sortable:!1,align:"center"}],headersClientes:[{sortable:!1,text:"Cliente",value:"nomeCliente"},{sortable:!1,text:"CPF",value:"cpf",align:"center"},{sortable:!1,text:"Operacao",value:"operacao",align:"center"},{sortable:!1,text:"Nascimento",value:"dataNascimento",align:"center"},{sortable:!1,text:"Dias Atraso",value:"diasAtraso",align:"center"},{sortable:!1,text:"Valor em Atraso",value:"valorAtraso",align:"right"},{sortable:!1,text:"Último Pagamento",value:"ultimoPagamento",align:"center"},{sortable:!1,text:"Loja",value:"nomeLoja"},{sortable:!1,align:"center"}],items:[],pagination:{rowsPerPage:15},totalItems:null,loading:!1,loadingBtn:!1}},watch:{pagination:{handler:function(){this.paginar()}}},beforeMount:function(){this.empresas.push({id:i["k"],descricao:"Todas Origens"})},methods:{novaRemessa:function(){var e=this;this.filtros.servicoSPC?this.filtros.diasEmAtraso?(this.flgNovaRemessa=!0,this.loading=!0,r["B"].novaRemesa(this.filtros).then(function(t){e.clientes=t.data}).catch(function(t){e.$root.showErro(t)}).finally(function(){e.loading=!1})):this.$root.showAlerta("O campo Dias em atraso é obrigatório"):this.$root.showAlerta("O campo Tipo é obrigatório")},gerarRemesa:function(){var e=this;this.loading=!0,r["B"].gerarRemesa(this.clientes,this.filtros.servicoSPC).then(function(t){e.clientes=t.data,e.$root.showSucesso("Remessa gerada com sucesso"),e.cancelarRemessa(),e.paginar()}).catch(function(t){e.$root.showErro(t),e.loading=!1})},cancelarRemessa:function(){this.flgNovaRemessa=!1,this.clientes=[]},onChangeServicoSPC:function(e){this.flgNovaRemessa=!1,this.filtros.servicoSPC=e,this.paginar()},pesquisar:function(){this.loadingBtn=!0,this.paginar()},paginar:function(){var e=this;this.filtros.servicoSPC&&(this.loading=!0,r["B"].pagination(this.pagination.rowsPerPage,this.pagination.page-1,this.pagination.sortBy||"id",this.filtros).then(function(t){e.items=t.data.content,e.totalItems=t.data.totalElements}).catch(function(t){e.$root.showErro(t)}).finally(function(){e.loading=!1}))},carregaEmpresas:function(e){var t=this;this.filtros.redeId=e,this.filtros.empresaId=i["k"],this.empresas=[],this.empresas.push({id:i["k"],descricao:"Todas Origens"}),r["C"].getAllEmpresasOfRede(e).then(function(e){t.empresas=t.empresas.concat(e.data)})},downloadAnexo:function(e){r["a"].downloadAnexo(e)}}},n=l,c=a("2877"),d=Object(c["a"])(n,s,o,!1,null,null,null);t["default"]=d.exports}}]);
//# sourceMappingURL=5148.df18c023.js.map