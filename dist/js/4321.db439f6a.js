(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["4321"],{4321:function(a,t,o){"use strict";o.r(t);var l=function(){var a=this,t=a.$createElement,o=a._self._c||t;return o("v-container",{attrs:{fluid:"","grid-list-md":""}},[a.flgNaoVender?[o("v-alert",{attrs:{value:!0,type:"warning"}},[o("span",{staticClass:"subheading"},[a._v("Cliente em análise de crédito! Não é possível realizar a venda, aguarde o retorno da nossa equipe.")])]),o("v-layout",{staticClass:"justify-end"},[o("v-btn",{staticStyle:{color:"black !important"},attrs:{outline:""},on:{click:a.cancelar}},[a._v("Cancelar")])],1)]:[o("core-progress-modal",{attrs:{show:a.loading}}),a.loading?a._e():o("v-layout",{attrs:{row:"",wrap:""}},[o("v-flex",{attrs:{md12:""}},[o("span",{staticClass:"body-2"},[a._v("Cliente: "+a._s(a.value.nome)+" CPF: "+a._s(a.value.cpf))])]),o("v-flex",{attrs:{md4:"",sm6:"",xs12:""}},[o("v-layout",{attrs:{"justify-center":"",row:"",wrap:""}},[o("v-flex",{staticClass:"headline text-md-center",attrs:{md12:""}},[o("span",[a._v("Escolha a forma de pagamento")])]),a._l(a.formasPagamento,function(t){return o("v-flex",{key:t,attrs:{sm6:"",xs12:""}},[o("a",{on:{click:function(o){a.selecionaTipoPagamento(t)}}},[o("v-btn",{attrs:{outline:a.dadosCalcular.formaPagamento!==t,color:a.dadosCalcular.formaPagamento===t?"#4caf50":"",disabled:a.dadosCalcular.formaPagamento!==t,large:""}},[a._v("\n                  "+a._s("CARNE"==t?"Carnê":"Boleto")+"\n                ")])],1)])})],2)],1),o("v-flex",{attrs:{md4:"",sm6:"",xs12:""}},[o("v-layout",{attrs:{row:"",wrap:""}},[o("v-flex",{staticClass:"headline text-md-center",attrs:{md12:""}},[a.limite&&a.limite>0?o("span",[a._v("Limite Disponível R$ "+a._s(a.limite.toLocaleString("pt-BR",{minimumFractionDigits:2})))]):o("span",{staticClass:"red--text"},[a._v("Sem Limite Disponível")])]),o("v-flex",{attrs:{md12:""}},[o("v-text-field",{attrs:{label:"Nome do Produto"},model:{value:a.dadosCalcular.nomeProduto,callback:function(t){a.$set(a.dadosCalcular,"nomeProduto","string"===typeof t?t.trim():t)},expression:"dadosCalcular.nomeProduto"}})],1),o("v-flex",{attrs:{md12:""}},[o("v-text-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"money",rawName:"v-money",value:a.money,expression:"money"}],attrs:{"error-messages":a.errors.collect("Valor do Produto"),"data-vv-name":"Valor do Produto",required:"",prefix:"R$",label:"Valor do Produto"},model:{value:a.dadosCalcular.vlProduto,callback:function(t){a.$set(a.dadosCalcular,"vlProduto",t)},expression:"dadosCalcular.vlProduto"}})],1),a.listPlanoPagamento.length>1?o("v-flex",{attrs:{md12:""}},[o("v-autocomplete",{attrs:{items:a.listPlanoPagamento,label:"Parcelar em até (Plano de Pagamento)","item-text":"descricao","item-value":"id"},on:{change:a.changePlanoPagamento},model:{value:a.dadosCalcular.planoPagamentoId,callback:function(t){a.$set(a.dadosCalcular,"planoPagamentoId",t)},expression:"dadosCalcular.planoPagamentoId"}})],1):a._e(),o("v-flex",{attrs:{md12:""}},[o("v-btn",{attrs:{loading:a.loadingBtn,block:"",color:"#4caf50"},on:{click:function(t){a.calcular()}}},[a._v("\n                Calcular\n              ")])],1),a.parcelasSimuladas.length>0?o("v-container",{attrs:{fluid:""}},[o("v-flex",{attrs:{md12:""}},[o("p",{staticClass:"headline"},[a._v("Entrada de R$\n\t\t\t  \t"),a.flagIncluir?a._e():o("span",{staticClass:"red--text"},[a._v(a._s(a.parcelasSimuladas[0].vlEntrada.toLocaleString("pt-BR",{minimumFractionDigits:2}))+"\n\t\t\t\t  ")]),o("v-icon",{attrs:{outline:"",color:"primary"},on:{click:a.incluirValor}},[a._v("\n\t\t\t\t\t\tmdi-pencil\n\t\t\t\t\t")]),a.flagIncluir?[o("v-flex",{attrs:{md10:""}},[o("v-text-field",{directives:[{name:"money",rawName:"v-money",value:a.money,expression:"money"}],attrs:{"error-messages":a.errors.collect("Valor da Entrada"),"data-vv-name":"Valor da Entrada",prefix:"R$",label:"Valor da Entrada"},model:{value:a.dadosCalcular.vlEntrada,callback:function(t){a.$set(a.dadosCalcular,"vlEntrada",t)},expression:"dadosCalcular.vlEntrada"}}),o("v-btn",{attrs:{loading:a.loadingBtn,small:"",color:"primary",elevation:"5",dark:""},on:{click:a.calcular}},[o("v-icon",{attrs:{dark:"",right:""}},[a._v("mdi-checkbox-marked")])],1),o("v-btn",{attrs:{small:"",color:"error",elevation:"5",dark:""},on:{click:a.cancelarEntrada}},[o("v-icon",{attrs:{dark:"",right:""}},[a._v("mdi-close-box")])],1)],1)]:a._e()],2)]),o("v-radio-group",{model:{value:a.dadosCalcular.parcelaSelecionada,callback:function(t){a.$set(a.dadosCalcular,"parcelaSelecionada",t)},expression:"dadosCalcular.parcelaSelecionada"}},a._l(a.parcelasSimuladas,function(t){return o("v-radio",{key:t.qtdParcela,attrs:{value:t}},[o("template",{slot:"label"},[o("span",{staticClass:"headline"},[a._v(a._s(t.qtdParcela+"x          R$"+t.vlPrimeiraParcela.toLocaleString("pt-BR",{minimumFractionDigits:2})))])])],2)}),1),o("v-btn",{attrs:{block:"",color:"#4caf50"},on:{click:a.autorizarCompra}},[a._v("\n                Autorizar Compra\n              ")])],1):a._e()],1)],1),o("v-flex",{attrs:{md4:"",sm6:"",xs12:""}},[a.loading?a._e():[o("v-layout",{staticClass:"justify-center",attrs:{wrap:"",row:""}},[o("div",{staticClass:"headline mb-3"},[o("span",[a._v("Possibilidades de Negociação")])]),o("div",{staticClass:"pa-2"},[o("apexchart",{attrs:{options:a.chartOptions,series:a.series,width:"300",height:"300",type:"donut"}})],1)])]],2),o("v-flex",{staticClass:"mt-5",attrs:{md12:""}},[o("v-layout",{staticClass:"justify-end"},[o("v-btn",{attrs:{dark:""},on:{click:a.goBack}},[a._v("Voltar")])],1)],1)],1),a.showDialogAutorizacao?o("core-autorizacao-compra",{attrs:{"cliente-nome":a.value.nome,"cliente-telefone":a.value.celular,"cliente-loja-id":a.value.lojaId,"nome-produto":a.dadosCalcular.nomeProduto,"valor-produto":a.dadosCalcular.vlProduto,"cliente-email":a.value.email,"lojista-email":a.lojistaEmail,callback:a.callbackAutorizacao,close:a.closeDialogAutorizacao}}):a._e()]],2)},e=[],n=o("3a86"),r={props:{value:{type:Object,required:!0},nextStep:{type:Function,requided:!0},goBack:{type:Function,requided:!0},setData:{type:Function,requided:!0},disabled:!1},data:function(){return{money:{decimal:",",thousands:".",precision:2,masked:!1},flgNaoVender:!1,flagIncluir:!1,loading:!1,loadingBtn:!1,formasPagamento:[],listPlanoPagamento:[],dadosCalcular:{nomeProduto:null,formaPagamento:"CARNE",vlProduto:null,vlEntrada:null,clienteId:null,lojaId:null,parcelaSelecionada:null,planoPagamentoId:null,autorizacaoId:null},limite:0,series:[40,30,30],scoreInicial:null,parcelasSimuladas:[],showDialogAutorizacao:!1,lojistaEmail:"",parcelarEm:null,chartOptions:{chart:{dropShadow:{enabled:!0,color:"#111",top:-1,left:3,blur:3,opacity:.2}},labels:[],stroke:{width:0},dataLabels:{enabled:!1,dropShadow:{blur:3,opacity:.8}},plotOptions:{pie:{donut:{labels:{show:!0,name:{show:!0,fontSize:"22px",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif",color:"#000",offsetY:20},value:{show:!0,fontSize:"30px",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif",color:"#000",offsetY:-30,formatter:function(a){return a.toLocaleString("pt-BR",{minimumFractionDigits:2})}}}}}},legend:{show:!1},colors:["#4caf50","#157DEC","#FF9800"]}}},watch:{value:function(){this.$emit("input",this.value)}},beforeMount:function(){var a=this;"ANALISE_VISUAL"===this.value.status?this.flgNaoVender=!0:(this.loading=!0,n["p"].getPlanospagamento(this.value.lojaId).then(function(t){a.listPlanoPagamento=t.data,null!=a.listPlanoPagamento&&a.listPlanoPagamento.length>0&&(a.dadosCalcular.planoPagamentoId=a.listPlanoPagamento[0].id)}).finally(function(){a.getDadosVenda()}))},methods:{seleciona:function(){"Carnê"!==this.formasPagamento?this.formasPagamento="Boleto":"Boleto"!==this.formasPagamento&&(this.formasPagamento="Carnê")},calcular:function(){var a=this;this.dadosCalcular.formaPagamento?this.dadosCalcular.nomeProduto?"0,00"!==this.dadosCalcular.vlProduto?(this.loadingBtn=!0,this.dadosCalcular.clienteId=this.value.id,this.dadosCalcular.lojaId=this.value.lojaId,this.parcelasSimuladas=[],n["E"].calcular(this.dadosCalcular).then(function(t){a.parcelasSimuladas=t.data}).catch(function(t){return a.$root.showAlerta(t.data)}).finally(function(){a.flagIncluir=!1,a.loadingBtn=!1})):this.$root.showAlerta("Informe o valor do produto"):this.$root.showAlerta("Informe o nome do produto"):this.$root.showAlerta("Informe a forma de pagamento")},cancelar:function(){this.$router.push("/lista-cliente")},cancelarEntrada:function(){this.loadingBtn=!0,this.flagIncluir=!1,this.loadingBtn=!1},incluirValor:function(){this.loadingBtn=!0,this.flagIncluir=!0,this.loadingBtn=!1},selecionaTipoPagamento:function(a){this.dadosCalcular.formaPagamento=a,this.parcelasSimuladas=[]},colorPagamento:function(a){return a===this.dadosCalcular.formaPagamento?"blue-grey darken-2":"grey lighten-3"},autorizarCompra:function(){this.dadosCalcular.parcelaSelecionada?this.showDialogAutorizacao=!0:this.$root.showAlerta("Selecione a quantidade de parcela")},callbackAutorizacao:function(a){var t=this;this.closeDialogAutorizacao(),this.dadosCalcular.autorizacaoId=a,this.loading=!0,n["E"].vender(this.dadosCalcular).then(function(a){t.value.vendaId=a.data.id,t.value.carneId=a.data.carneId,t.nextStep()}).catch(function(a){return t.$root.showErro(a.data.message)}).finally(function(){t.loading=!1})},closeDialogAutorizacao:function(){this.showDialogAutorizacao=!1},getDadosVenda:function(){var a=this;this.loading=!0,n["p"].getDadosVenda(this.value.lojaId,this.dadosCalcular.planoPagamentoId).then(function(t){a.formasPagamento=t.data.formasPagamento,a.lojistaEmail=t.data.lojistaEmail||"",a.parcelarEm=t.data.parcelarEm}).finally(function(){n["h"].getLimiteDisponivel(a.value.id,a.value.lojaId).then(function(t){a.limite=t.data}).finally(function(){n["h"].consultaScore(a.value.id,a.value.lojaId).then(function(t){a.scoreInicial=t.data,a.series[0]=a.scoreInicial.faixaFinal1,a.series[1]=a.scoreInicial.faixaFinal2,a.series[2]=a.scoreInicial.faixaFinal3,a.chartOptions.labels[0]=a.scoreInicial.peEntrada1?" 1 + "+a.parcelarEm+"x":a.parcelarEm+"x",a.chartOptions.labels[1]=a.scoreInicial.peEntrada2?" 1 + "+a.parcelarEm+"x":a.parcelarEm+"x",a.chartOptions.labels[2]=a.scoreInicial.peEntrada3?" 1 + "+a.parcelarEm+"x":a.parcelarEm+"x"}).catch(function(){return console.log("Erro na consultaScore")}).finally(function(){a.loading=!1})})})},changePlanoPagamento:function(a){this.dadosCalcular.planoPagamentoId=a,this.parcelasSimuladas=[],this.getDadosVenda()}}},i=r,s=o("2877"),c=Object(s["a"])(i,l,e,!1,null,null,null);t["default"]=c.exports}}]);
//# sourceMappingURL=4321.db439f6a.js.map