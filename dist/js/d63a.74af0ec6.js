(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["d63a"],{d63a:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-form",{ref:"form2",on:{submit:function(e){return e.preventDefault(),t.validateBeforeSubmit(e)}}},[a("core-progress-modal",{attrs:{show:t.loading}}),t.loading?t._e():a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md12:""}},[a("v-card",{staticClass:"elevation-0"},[a("v-card-title",[a("h3",{staticClass:"headline mb-0"},[t._v("Selecione as empresas para repasse")])]),a("v-card-text",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md3:""}},[a("core-label-value",{attrs:{label:"Rede",value:t.value.redeNome}})],1),a("v-flex",{attrs:{md3:""}},[a("core-label-value",{attrs:{label:"Empresa",value:t.value.empresaNome}})],1),a("v-flex",{attrs:{md2:""}},[a("core-label-value",{attrs:{label:"Vencimento até",value:t._f("moment")(t.value.vencimentoAte,"DD/MM/YYYY")}})],1),a("v-flex",{attrs:{md2:""}},[a("core-label-value",{attrs:{label:"Pagamento em",value:t._f("moment")(t.value.pagamentoEm,"DD/MM/YYYY")}})],1)],1)],1)],1)],1),a("v-flex",{attrs:{md12:""}},[a("v-card",{staticClass:"elevation-0"},[a("v-card-text",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md2:""}},[a("core-label-value",{attrs:{label:"Compras",value:t.vlTotalSelecionado("vlTotalCompras")}})],1),a("v-flex",{attrs:{md2:""}},[a("core-label-value",{attrs:{label:"Comissão compras",value:t.vlTotalSelecionado("vlTotalComissaoCompras")}})],1),a("v-flex",{attrs:{md2:""}},[a("core-label-value",{attrs:{label:"Créditos admin",value:t.vlTotalSelecionado("vlTotalCreditoAdmin")}})],1),a("v-flex",{attrs:{md2:""}},[a("core-label-value",{attrs:{label:"Pagamentos loja",value:t.vlTotalSelecionado("vlTotalPagamentosLoja")}})],1),a("v-flex",{attrs:{md2:""}},[a("core-label-value",{attrs:{label:"Créditos lojista",value:t.vlTotalSelecionado("vlTotalCreditoLojista")}})],1),a("v-flex",{attrs:{md2:""}},[a("core-label-value",{attrs:{label:"Valor a pagar",value:t.vlTotalSelecionado("vlTotalPagar"),"class-value":"headline font-weight-black"}})],1)],1)],1)],1)],1),a("v-flex",{staticClass:"layout row align-center",attrs:{md12:""}},[a("v-btn",{attrs:{color:"primary"},on:{click:t.gerarArquivoTEDs}},[t._v("\n          Gerar Arquivo Para TEDs\n        ")]),a("span",{staticClass:"ml-1 body-2"},[t._v("Gera um arquivo de transferência com as informações bancárias e valores das lojas selecionadas, esse arquivo deverá ser enviado ao banco para realização das TEDs.")])],1),a("v-flex",{attrs:{md12:""}},[a("v-card",[a("v-data-table",{staticClass:"elevation-1 arrow-pagintion",attrs:{headers:t.headers,items:t.listaLojaRepasse,expand:!1,"hide-actions":"","select-all":"","item-key":"lojaId"},scopedSlots:t._u([{key:"headers",fn:function(e){return[a("tr",[a("th",{staticStyle:{width:"5%"}},[t._v("\n                   \n                ")]),a("th",{staticStyle:{width:"5%"}},[a("v-checkbox",{attrs:{"input-value":e.all,indeterminate:e.indeterminate,primary:"","hide-details":""},nativeOn:{click:function(e){return t.toggleAll(e)}}})],1),t._l(e.headers,function(e){return a("th",{key:e.text,class:e.class},[t._v("\n                  "+t._s(e.text)+"\n                ")])})],2)]}},{key:"items",fn:function(e){return[a("tr",{attrs:{active:e.selected}},[a("td",[a("v-icon",{on:{click:function(t){e.item.expanded=!e.item.expanded}}},[t._v("\n                    "+t._s(e.item.expanded?"mdi-minus":"mdi-plus")+"\n                  ")])],1),a("td",[a("v-checkbox",{attrs:{"input-value":e.selected,primary:"","hide-details":""},on:{click:function(t){e.selected=!e.selected}}})],1),a("td",[a("span",{staticClass:"body-2"},[t._v(t._s(e.item.nomeEmpresa))])]),a("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.vlTotalCompras.toLocaleString("pt-BR",{minimumFractionDigits:2})))]),a("td",{directives:[{name:"negative",rawName:"v-negative",value:e.item.vlTotalComissaoCompras,expression:"props.item.vlTotalComissaoCompras"}],staticClass:"text-xs-right"},[t._v("\n                  "+t._s(e.item.vlTotalComissaoCompras.toLocaleString("pt-BR",{minimumFractionDigits:2}))+"\n                ")]),a("td",{directives:[{name:"negative",rawName:"v-negative",value:e.item.vlTotalCreditoAdmin,expression:"props.item.vlTotalCreditoAdmin"}],staticClass:"text-xs-right"},[t._v("\n                  "+t._s(e.item.vlTotalCreditoAdmin.toLocaleString("pt-BR",{minimumFractionDigits:2}))+"\n                ")]),a("td",{directives:[{name:"negative",rawName:"v-negative",value:e.item.vlTotalPagamentosLoja,expression:"props.item.vlTotalPagamentosLoja"}],staticClass:"text-xs-right"},[t._v("\n                  "+t._s(e.item.vlTotalPagamentosLoja.toLocaleString("pt-BR",{minimumFractionDigits:2}))+"\n                ")]),a("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.vlTotalCreditoLojista.toLocaleString("pt-BR",{minimumFractionDigits:2})))]),a("td",{directives:[{name:"negative",rawName:"v-negative",value:e.item.vlTotalPagar,expression:"props.item.vlTotalPagar"}],staticClass:"text-xs-right"},[t._v("\n                  "+t._s(e.item.vlTotalPagar.toLocaleString("pt-BR",{minimumFractionDigits:2}))+"\n                ")])]),e.item.expanded?a("tr",[a("td",{attrs:{colspan:"10"}},[a("v-data-table",{staticClass:"elevation-1 arrow-pagintion",attrs:{headers:t.headersItems,items:e.item.items,"hide-actions":""},scopedSlots:t._u([{key:"items",fn:function(e){var s=e.item;return[a("tr",[a("td",{staticClass:"text-xs-center"},[t._v(t._s(t._f("moment")(s.vencimento,"DD/MM/YYYY")))]),a("td",{staticClass:"text-xs-center"},[t._v(t._s(s.vlTotalCompras.toLocaleString("pt-BR",{minimumFractionDigits:2})))]),a("td",{directives:[{name:"negative",rawName:"v-negative",value:s.vlTotalComissaoCompras,expression:"item.vlTotalComissaoCompras"}],staticClass:"text-xs-center"},[t._v("\n                          "+t._s(s.vlTotalComissaoCompras.toLocaleString("pt-BR",{minimumFractionDigits:2}))+"\n                        ")]),a("td",{directives:[{name:"negative",rawName:"v-negative",value:s.vlTotalCreditoAdmin,expression:"item.vlTotalCreditoAdmin"}],staticClass:"text-xs-center"},[t._v("\n                          "+t._s(s.vlTotalCreditoAdmin.toLocaleString("pt-BR",{minimumFractionDigits:2}))+"\n                        ")]),a("td",{directives:[{name:"negative",rawName:"v-negative",value:s.vlTotalPagamentosLoja,expression:"item.vlTotalPagamentosLoja"}],staticClass:"text-xs-center"},[t._v("\n                          "+t._s(s.vlTotalPagamentosLoja.toLocaleString("pt-BR",{minimumFractionDigits:2}))+"\n                        ")]),a("td",{staticClass:"text-xs-center"},[t._v(t._s(s.vlTotalCreditoLojista.toLocaleString("pt-BR",{minimumFractionDigits:2})))]),a("td",{directives:[{name:"negative",rawName:"v-negative",value:s.vlTotalPagar,expression:"item.vlTotalPagar"}],staticClass:"text-xs-center"},[t._v("\n                          "+t._s(s.vlTotalPagar.toLocaleString("pt-BR",{minimumFractionDigits:2}))+"\n                        ")])])]}}])})],1)]):t._e()]}}]),model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1)],1),a("v-flex",{attrs:{md12:""}},[a("v-layout",{staticClass:"justify-end"},[a("v-btn",{attrs:{dark:""},on:{click:t.goBack}},[t._v("Voltar")]),a("v-btn",{attrs:{disabled:t.disableBtn,loading:t.loadingBtn,type:"submit",color:"primary"}},[t._v("Continuar")])],1)],1)],1)],1)],1)},l=[],i=(a("96cf"),a("1da1")),o=a("5a50"),n=a("3a86"),r={props:{value:{type:Object,required:!0},setData:{type:Function,requided:!0},goBack:{type:Function,requided:!0},nextStep:{type:Function}},data:function(){return{selected:[],listaLojaRepasse:[],money:o["i"],loadingBtn:!1,headers:[{sortable:!1,text:"Empresa",value:"nomeEmpresa",class:"grey lighten-1",align:"left"},{sortable:!1,text:"Compras",value:"compras",class:"grey lighten-1",align:"center"},{sortable:!1,text:"Comissão compras",value:"comissaoCompras",class:"grey lighten-1",align:"center"},{sortable:!1,text:"Créditos admin",value:"creditosAdmin",class:"grey lighten-1",align:"center"},{sortable:!1,text:"Pagtos em loja",value:"pagtosLoja",class:"grey lighten-1",align:"center"},{sortable:!1,text:"Créditos lojista",value:"creditosLojista",class:"grey lighten-1",align:"center"},{sortable:!1,text:"Valor a pagar",value:"valorPagar",class:"grey lighten-1",align:"center"}],headersItems:[{sortable:!1,text:"Vencimento",value:"dataVencimento",class:"grey lighten-1",align:"center"},{sortable:!1,text:"Compras",value:"compras",class:"grey lighten-1",align:"center"},{sortable:!1,text:"Comissão compras",value:"comissaoCompras",class:"grey lighten-1",align:"center"},{sortable:!1,text:"Créditos admin",value:"creditosAdmin",class:"grey lighten-1",align:"center"},{sortable:!1,text:"Pagtos em loja",value:"pagtosLoja",class:"grey lighten-1",align:"center"},{sortable:!1,text:"Créditos lojista",value:"creditosLojista",class:"grey lighten-1",align:"center"},{sortable:!1,text:"Valor a pagar",value:"valorPagar",class:"grey lighten-1",align:"center"}],totalItems:null,loading:!1}},computed:{disableBtn:function(){return 0===this.selected.length}},watch:{value:function(){this.$emit("input",this.value)}},beforeMount:function(){var t=this;this.loading=!0,n["y"].calculaRepasseGeral(this.value).then(function(e){t.listaLojaRepasse=e.data,t.toggleAll()}).finally(function(){t.loading=!1})},methods:{toggleAll:function(){this.selected.length?this.selected=[]:this.selected=this.listaLojaRepasse.slice()},validateBeforeSubmit:function(){var t=this;this.$validator.validate().then(function(e){e?(t.loadingBtn=!0,t.value.lojasSelecionadas=t.selected.map(function(t){return t.lojaId}),t.nextStep()):t.$root.showAlerta(t.$vuetify.t("$vuetify.Erro.camposObrigatorios"))})},vlTotalSelecionado:function(t){return 0===this.selected.length?this.value.extratoRepasse[t]="0,00":this.value.extratoRepasse[t]=this.selected.map(function(e){return e[t]}).reduce(function(t,e){return t+e}).toLocaleString("pt-BR",{minimumFractionDigits:2}),this.value.extratoRepasse[t]},gerarArquivoTEDs:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.value.lojasSelecionadas=this.selected.map(function(t){return t.lojaId}),this.value.lojasSelecionadas&&this.value.lojasSelecionadas.length>0?(this.loading=!0,n["y"].gerarArquivoTEDs(this.value).then(function(t){var a=window.URL.createObjectURL(new Blob([t.data])),s=document.createElement("a");s.href=a,s.setAttribute("download","Arquivo-TEDs-"+e.$moment().format("DD-MM-YYYY H:mm")+".txt"),document.body.appendChild(s),s.click(),e.loading=!1}).catch(function(t){e.loading=!1,e.$root.showErro(t.data)})):this.$root.showAlerta("Selecione no mínimo uma loja");case 2:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()}},c=r,m=a("2877"),v=Object(m["a"])(c,s,l,!1,null,null,null);e["default"]=v.exports}}]);
//# sourceMappingURL=d63a.74af0ec6.js.map